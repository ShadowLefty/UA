<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Illusion • Arquivos Seguros</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Mesmo favicon do ilu.html -->
  <link rel="icon" type="image/png" href="https://media.tenor.com/o0mvoouLlywAAAAe/pfp.png" />

  <style>
    /* --------- RESET / BASE --------- */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --bg: #020202;
      --bg-soft: #050505;
      --fg: #f5f5f5;
      --fg-soft: #c7c7c7;
      --accent: #e53935;
      --border: #2a2a2a;
      --mono: "Consolas", "Fira Code", "SF Mono", Menlo, Monaco, monospace;
      --sans: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;

      --term-bg: #050505;
      --term-border: #262626;
      --term-text: #e0f2f1;
      --term-green: #4df2a1;
      --term-green-soft: #66ffa6;
      --term-magenta: #ff80ff;
      --term-pink: #ff79b0;
      --term-error: #ff8a80;
      --term-muted: #8f9ba5;
    }

    html, body { height: 100%; }

    body {
      background: radial-gradient(circle at top, #181818 0, #020202 55%);
      color: var(--fg);
      font-family: var(--sans);
      display: flex;
      flex-direction: column;
      align-items: stretch;
      overflow-x: hidden;
    }

    /* --------- VHS OVERLAY --------- */
    .vhs-overlay::before,
    .vhs-overlay::after {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
    }

    .vhs-overlay::before {
      background: repeating-linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0.03) 0,
        rgba(255, 255, 255, 0.03) 1px,
        transparent 2px,
        transparent 3px
      );
      mix-blend-mode: screen;
      opacity: 0.25;
    }

    @keyframes vhs-noise {
      0% { opacity: 0.08; transform: translate3d(0,0,0); }
      20% { opacity: 0.12; transform: translate3d(-1px, 1px, 0); }
      40% { opacity: 0.06; transform: translate3d(1px, -1px, 0); }
      60% { opacity: 0.1; transform: translate3d(0, 0, 0); }
      80% { opacity: 0.05; transform: translate3d(-0.5px, 0.5px, 0); }
      100% { opacity: 0.09; transform: translate3d(0, 0, 0); }
    }

    .vhs-overlay::after {
      background-image:
        repeating-linear-gradient(
          0deg,
          rgba(0, 0, 0, 0.3) 0,
          rgba(0, 0, 0, 0.3) 1px,
          transparent 1px,
          transparent 3px
        );
      animation: vhs-noise 0.4s infinite;
      mix-blend-mode: soft-light;
    }

    /* --------- FRAME / HEADER --------- */
    .frame {
      position: relative;
      z-index: 2;
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
      padding: 16px 18px 48px;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 12px;
      margin-bottom: 20px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .eye-video {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      overflow: hidden;
      border: 2px solid #f5f5f5;
      box-shadow: 0 0 8px rgba(255, 255, 255, 0.12);
    }

    .eye-video video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .brand-text { line-height: 1.2; }

    .brand-title {
      font-size: 15px;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
    }

    .brand-sub {
      font-size: 11px;
      color: var(--fg-soft);
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    nav {
      display: flex;
      gap: 10px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    nav a {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      color: var(--fg-soft);
      text-decoration: none;
      transition: 0.15s ease;
      font-family: var(--mono);
    }

    nav a:hover,
    nav a:focus-visible {
      border-color: var(--fg);
      color: var(--fg);
      background: #101010;
      outline: none;
    }

    /* --------- PAINEL DE ACESSO --------- */
    .access-main {
      margin-top: 20px;
      max-width: 960px;
    }

    .panel-access {
      border-radius: 12px;
      border: 1px solid var(--border);
      background: radial-gradient(circle at top, #151515 0, #050505 60%);
      padding: 18px 18px 20px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.35);
      position: relative;
      overflow: hidden;
    }

    .panel-access::before {
      content: "ILLUSION // ACCESS LOGGED";
      position: absolute;
      top: 10px;
      right: 14px;
      font-family: var(--mono);
      font-size: 9px;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255, 255, 255, 0.18);
    }

    .badge-inline {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-family: var(--mono);
      font-size: 10px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(229, 57, 53, 0.4);
      background: rgba(229, 57, 53, 0.12);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: #ffb3b1;
      margin-bottom: 10px;
    }

    .panel-access h1 {
      font-size: 18px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      margin-bottom: 6px;
      font-family: var(--mono);
    }

    .panel-access p {
      color: var(--fg-soft);
      line-height: 1.6;
      font-size: 13px;
      max-width: 42rem;
      margin-bottom: 10px;
    }

    .form-grid {
      display: grid;
      gap: 12px;
      margin-top: 12px;
    }

    .form-field label {
      font-size: 11px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--fg-soft);
      font-family: var(--mono);
      margin-bottom: 4px;
      display: block;
    }

    .form-field input {
      background: #0f0f0f;
      border: 1px solid var(--border);
      color: var(--fg);
      padding: 10px 10px;
      border-radius: 8px;
      font-family: var(--mono);
      font-size: 12px;
    }

    .form-field input:focus-visible {
      border-color: var(--accent);
      outline: none;
      box-shadow: 0 0 0 2px rgba(229, 57, 53, 0.2);
    }

    .access-actions {
      margin-top: 10px;
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    .btn-primary {
      border-radius: 999px;
      padding: 9px 15px;
      border: 1px solid var(--fg);
      background: var(--fg);
      color: #000;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      font-family: var(--mono);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: 0.15s ease;
    }

    .btn-primary:hover {
      filter: brightness(0.9);
      transform: translateY(-1px);
    }

    .error {
      color: #ff8c8a;
      font-family: var(--mono);
      font-size: 11px;
      min-height: 16px;
      margin-top: 4px;
    }

    /* --------- BLOCO PROTEGIDO --------- */
    .protected-block {
      display: none;
      margin-top: 18px;
      border-top: 1px solid var(--border);
      padding-top: 14px;
    }

    .protected-block.visible {
      display: block;
    }

    .protected-title {
      font-family: var(--mono);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      margin-bottom: 8px;
      color: var(--fg-soft);
    }

    /* --------- TERMINAL --------- */
    .terminal {
      border-radius: 10px;
      border: 1px solid var(--term-border);
      background: radial-gradient(circle at top, #070707 0, #020202 60%);
      padding: 10px 12px 10px;
      font-family: var(--mono);
      font-size: 12px;
      color: var(--term-text);
      max-height: 420px;
      display: flex;
      flex-direction: column;
    }

    .terminal-output {
      flex: 1;
      overflow-y: auto;
      padding-right: 4px;
      white-space: pre-wrap;
    }

    .terminal-line {
      line-height: 1.4;
    }

    .term-system { color: var(--term-green); }
    .term-muted  { color: var(--term-muted); }
    .term-error  { color: var(--term-error); }
    .term-prompt-line { color: var(--term-pink); }
    .term-header { color: var(--term-green-soft); font-weight: 600; }

    .terminal-form {
      display: flex;
      align-items: center;
      margin-top: 6px;
      border-top: 1px solid var(--term-border);
      padding-top: 4px;
    }

    .prompt-label {
      margin-right: 6px;
      color: var(--term-magenta);
      font-size: 12px;
    }

    #terminal-input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      color: var(--term-text);
      font-family: var(--mono);
      font-size: 12px;
      padding: 4px 2px;
    }

    #terminal-input::placeholder {
      color: #455a64;
      opacity: 0.8;
    }

    /* --------- FOOTER --------- */
    footer {
      margin-top: 22px;
      font-family: var(--mono);
      font-size: 10px;
      color: var(--fg-soft);
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 1px solid var(--border);
      padding-top: 8px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .timecode { letter-spacing: 0.18em; }

    .badge {
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 3px 8px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }
  </style>
</head>
<body class="vhs-overlay">
  <div class="frame">
    <!-- HEADER -->
    <header>
      <div class="brand">
        <div class="eye-video">
          <video src="https://media.tenor.com/o0mvoouLlywAAAPo/pfp.mp4" autoplay loop muted playsinline></video>
        </div>
        <div class="brand-text">
          <div class="brand-title">Illusion</div>
          <div class="brand-sub">Arquivos Seguros</div>
        </div>
      </div>

      <nav>
        <a href="ilu.html">Portal</a>
        <a href="arquivos.html">Arquivos</a>
        <a href="operacoes.html">Informações</a>
        <a href="laboratorios.html">Sítios</a>
        <a href="contato.html">Contato</a>
      </nav>
    </header>

    <!-- CONTEÚDO -->
    <main class="access-main">
      <section class="panel-access">
        <span class="badge-inline">Nível Vermelho · Necessário usuário e senha</span>
        <h1>Acesso aos arquivos</h1>
        <p>
          Somente operadores autenticados podem consultar dossiês de agentes e
          arquivos classificados da Illusion. Todas as consultas são registradas e
          auditadas pelo V.I.S.
        </p>

        <!-- LOGIN -->
        <form id="login-form" class="form-grid">
          <div class="form-field">
            <label for="user">Usuário</label>
            <input id="user" name="user" autocomplete="username" required placeholder="......" />
          </div>
          <div class="form-field">
            <label for="pass">Senha</label>
            <input id="pass" name="pass" type="password" autocomplete="current-password" required placeholder="••••••••" />
          </div>

          <div class="access-actions">
            <button type="submit" class="btn-primary">Validar credenciais</button>
            <span class="error" id="error"></span>
          </div>
        </form>

        <!-- TERMINAL PROTEGIDO -->
        <section class="protected-block" id="protected-block">
          <div class="protected-title">Illusion // Agent & File Terminal</div>
          <div class="terminal" id="terminal">
            <div class="terminal-output" id="terminal-output"></div>
            <form class="terminal-form" id="terminal-form">
              <span class="prompt-label">&gt;</span>
              <input
                id="terminal-input"
                type="text"
                autocomplete="off"
                spellcheck="false"
                placeholder="digite 'help' para comandos disponíveis..."
              />
            </form>
          </div>
        </section>
      </section>
    </main>

    <!-- FOOTER -->
    <footer>
      <div class="timecode">▶ 01:03:27 • Illusion Tape // Agent Terminal Node</div>
      <div class="badge">Illusion • Consulta de arquivos monitorada</div>
    </footer>
  </div>

  <script>
    // --------- LOGIN ---------
    const form = document.getElementById('login-form');
    const protectedBlock = document.getElementById('protected-block');
    const error = document.getElementById('error');

    const VALID_USERS = [
      {
        user: 'fyodor',
        pass: 'MvsS_Paradox13',
        codename: 'FYODOR',
        access: 'NA-A'
      },
      {
        user: 'yuigui',
        pass: 'cal123',
        codename: 'YUIGUI',
        access: 'NA-I'
      }
    ];

    let currentUser = null;

    form.addEventListener('submit', (event) => {
      event.preventDefault();
      const user = form.user.value.trim();
      const pass = form.pass.value.trim();

      const found = VALID_USERS.find(
        (u) => u.user === user && u.pass === pass
      );

      if (found) {
        currentUser = found;
        protectedBlock.classList.add('visible');
        error.textContent = '';
        form.style.display = 'none';
        initTerminalSession();
      } else {
        error.textContent = 'Credenciais inválidas ou insuficientes.';
      }
    });

    // --------- DADOS: AGENTES & ARQUIVOS ---------
    const AGENTS = [
      {
        nome: 'F.D',
        id: '█████',
        acesso: 'NA-█',
        divPrim: null,
        divSec: null,
        quirk: null,
        descFisica: null,
        descricao: null,
        historico: null,
        anomalias: null,
        observacoes: null
      },
      {
        nome: 'Y.Y',
        id: '█████',
        acesso: 'NA-█',
        divPrim: null,
        divSec: null,
        quirk: null,
        descFisica: null,
        descricao: null,
        historico: null,
        anomalias: null,
        observacoes: null
      },
      {
        nome: 'Shinichi Kudo - Conan Edogawa',
        id: 'S-07.ESP',
        acesso: 'NA-I',
        divPrim: 'E.S.P.',
        divSec: 'A.R.C.',
        quirk: '“Detective Conan” – cérebro estruturado como um sistema de arquivamento em camadas. Registra com precisão quase absoluta tudo o que percebe (visão, som, cheiros, padrões de movimento), indexando por data, hora e contexto. Consegue “reabrir” memórias como se fossem gravações e cruzar informações em alta velocidade.',
        descFisica: 'Originalmente 1,74 m, constituição magra e atlética, cabelos pretos bagunçados e olhos azuis marcantes. Após exposição a droga experimental, corpo regredido para cerca de 1,02 m, aparência infantil, mantendo mesma coloração de olhos e cabelo. Costuma usar óculos redondos, boné/boina de detetive ou casaco longo que reforçam a fachada de “criança curiosa”.',
        descricao: 'Pródigo em dedução lógica e observação de microdetalhes, reconhecido como “detetive dos detetives” em registros civis antes do incidente. Mantém postura analítica mesmo em situações de risco, priorizando a proteção de civis. Age como civil comum na maior parte do tempo, usando a forma infantil como cobertura para circular despercebido em perímetros de investigação.',
        historico: 'Atualmente, está em investigações ligadas à máfia japonesa e ao caso “Mayura Uzumaki”. - Usou a CDI para garantir mais informações, entregando 100k para quem ceder mais informações.',
        anomalias: null,
        observacoes: null
      },
      {
        nome: 'Jun Zhi - Kong Kong’Er',
        id: 'J-04.REC - FIELD OPERATIVE (UNSTABLE PROFILE)',
        acesso: 'NA-B',
        divPrim: 'R.E.C.',
        divSec: null,
        quirk: '"Mão de Ladrão." - Ele pode emitir uma luva branca com um olho roxo onde ficaria à palma da mão, ele absorve os item ou outras quirk que cujuram algo e tomar posse dele.',
        descFisica: 'Indivíduo do sexo masculino, 21 anos, porte leve, altura aproximada de 1,69m. Apresenta tatuagens faciais e cervicais, cicatriz extensa no lado direito do rosto, olhos escurecidos com padrão assimétrico e traços faciais que enfatizam expressões de sadismo. Cabelos longos presos em coque ou rabo lateral.',
        descricao: 'Elemento altamente instável. Personalidade manipuladora, mentirosa e orientada ao caos, porém extremamente articulada. Demonstra padrões de comportamento sugestivos de sadismo leve a severo, acompanhados de impulsos moralmente distorcidos. Sua motivação declarada: “igualdade entre todos os seres”, parece servir como racionalização filosófica para atos ilícitos.',
        historico: 'Envolvimento numa luta com o IL-096.',
        anomalias: 'IL-096, olhou diretamente em seus olhos e teve contato físico.',
        observacoes: 'Desconfiável.'
      },
{
  nome: 'Li Xin-"n"',
  id: 'L-11.INT',
  acesso: 'NA-B',
  divPrim: null,
  divSec: 'I.N.T.',
  quirk: '"Forma da Luz e Trevas." — O usuário alterna entre dois estados anômalos: um modo berserker sombrio que amplifica força e agressividade; e um modo luminoso que expande raciocínio tático, rapidez analítica e libera ataques de energia.',
  descFisica: 'Indivíduo do sexo masculino, 31 anos, altura aproximada de 1,89m. Porte atlético, traços orientais, longos cabelos azul-escuros frequentemente presos. Apresenta marcas corporais irregulares decorrentes de fusão com entidade IL-071 (regiões cinzentas e textura pétrea visível em ombro, pescoço e lateral do rosto).',
  descricao: 'Sujeito apresenta dualidade comportamental severa: alterna rapidamente entre estados emocionais opostos, impulsividade caótica, agressão e instabilidade; e, em contraste, uma persona extremamente calma, racional, estratégica e previsivelmente perigosa. A alternância parece ser parcialmente influenciada pela entidade acoplada. Motivação atual: desconhecida. Histórico prévio aponta função religiosa como guardião de templo dedicado a estatuetas anímicas.',
  historico: 'Envolvido no incidente “Templo das Estatuetas”, onde estatuetas anômalas foram libertadas após ataque externo. O sujeito encontrou essa estatueta e tornou-se hospedeiro da entidade IL-071. Considerado indivíduo de risco elevado.',
  anomalias: 'IL-071 “Murmúrio de Mármore” — entidade simbiótica acoplada ao lado direito do corpo do sujeito. Efeitos incluem percepção expandida, resistência anormal, reverberações de impacto, distorção sensorial e potencial de fusão total.',
  observacoes: 'Alta instabilidade emocional. A entidade interfere nos reflexos, percepção e decisões do sujeito. Requer monitoramento constante. Não recomendado contato visual prolongado.'
},
{
  nome: 'Chyba',
  id: 'C-16.REC',
  acesso: 'NA-B',
  divPrim: 'R.E.C.',
  divSec: null,

  quirk: '"Erro." — Habilidade de emissão que distorce seletivamente os sentidos de um alvo. Pode gerar cegueira estática (visão como TV fora do ar), ruído branco ensurdecedor, perda de sensibilidade tátil/olfativa e confusão sensorial aguda. Atua em um sentido por vez e exige manipulação precisa.',
  descFisica: 'Indivíduo do sexo feminino, 16 anos, altura aproximada de 1,66m. Porte leve, aparência juvenil. Cabelos multicoloridos com padrão irregular, comportamento visual marcante associado à manifestação da Quirk. Íris escuras e pele clara. Mostra gestualidade expressiva e movimentos rápidos, sugerindo alta agilidade.',
  descricao: 'Chyba apresenta personalidade instável, mas funcional para operações de campo. Considera-se uma “heroína”, mantendo moralidade idealista e impulsos de provar seu próprio valor. Demonstrou afinidade excepcional com ambientes labirínticos, jogos mentais e manipulação estratégica de percepção alheia. Alta adaptabilidade emocional, porém pouca experiência prática.',
  historico: 'Participou na captura da IL-096, desabilitando o sexto sentido da criatura.',
  anomalias: 'IL-096, contato indireto por quirk.',
  observacoes: null
},
{
  nome: 'Kying Syouta',
  id: 'DK-16.VANG',
  acesso: 'NA-A',
  divPrim: 'V.A.N.G.',
  divSec: 'R.E.C.',

  quirk: '"A Unção do Maculado." — Quirk emissora dividida em dois ramos distintos: \
(1) Vertente Ígnea: através de autoflagelação ritual na palma das mãos, o usuário \
imbuí sua katana com sangue ativado, produzindo chamas de até 570°C e aprimorando o fio da lâmina. \
(2) Vertente Elétrica: Kying acumula carga elétrica nas mãos ou na espada, tornando golpes mais rápidos e cortantes, \
podendo liberar um choque exteriorizado após período de carga. Não eletrocuta alvos diretamente pelo metal, apenas amplifica corte e impacto.',
  descFisica: 'Indivíduo do sexo masculino, 16 anos, 1,63m, 64kg. Porte leve a médio, musculatura definida por prática constante de kenjutsu. \
Cabelos longos e avermelhados, normalmente soltos. Possui cicatrizes extensas no rosto e torso, algumas em formato de X. \
Apresenta comportamento corporal rígido, postura tradicional e movimentos calculados, típicos de espadachim disciplinado.',
  descricao: 'Operativo jovem com perfil extremamente rígido, sério e orientado por valores morais próprios. Demonstra disciplina elevada, forte integridade pessoal e uma filosofia idealista que enxerga seus atos, mesmo quando violentos, como parte do “expurgo do mal”. Pode ser percebido como ríspido e amargo, mas mantém senso de honra firme. Alto foco em objetivos e promessa familiar, especialmente ligada à figura de sua irmã.',
  historico: 'Registros preliminares apontam que Kying atuava como samurai errante antes de contato com a Illusion. Demonstrou maestria com lâminas desde criança, desenvolvendo estilo híbrido entre disciplina tradicional e técnicas pessoais.',
  anomalias: null,
  observacoes: null
},
{
  nome: 'KAMINOBU',
  id: 'DK-12.LINK',
  acesso: 'NA-E	',
  divPrim: 'L.I.N.K.',
  divSec: null,

  quirk: '"Haku-Jōdai." — Quirk emissora baseada em manipulação espiritual. O usuário mantém duas entidades esféricas (tsueshiro) que respondem a comandos diretos, servindo como projéteis, sensores, mensageiros ou mecanismos de transporte por teletransporte envolto em fumaça branca. As esferas são imateriais e não podem ser destruídas, mas se dissipam caso o usuário perca foco ou energia mental.',

  descFisica: 'Indivíduo do sexo masculino, 12 anos, 1,49m, 44kg. Aparência juvenil, traços leves, postura animada e expressiva. Costuma usar uniforme estilizado com chapéu característico. Geralmente visto acompanhado das tsueshiro flutuantes. Estado físico saudável, porém com resistência limitada devido à idade.',

  descricao: 'Apesar da idade extremamente baixa, Kaminobu demonstra inteligência acima de parâmetros normais, exibindo raciocínio avançado, capacidade de análise e memória excepcional. Personalidade gentil, alegre e inocente, contrastando com função de alta responsabilidade. É socialmente afável, curioso e cooperativo. Mente analítica semelhante à de profissionais adultos, porém mantém ingenuidade emocional significativa. Preferido pelo Conselho devido à ausência de ambição e alto nível de obediência estrutural.',

  historico: 'Recrutado após avaliação da divisão HALO, que identificou atividade espiritual anômala em residência familiar. As tsueshiro demonstraram compatibilidade absoluta com o sujeito, criando forte vínculo. Após diversos testes cognitivos, Kaminobu superou todos os índices de operadores da divisão L.I.N.K., assumindo eventualmente posição de Diretor devido à sua precisão lógica e ausência de viés ideológico. Sua nomeação é classificada e justificada como "Exceção Estrutural".',

  anomalias: null,

  observacoes: null
}
    ];

    const FILES = [
      {
        codigo: 'IL-079',
        titulo: 'Dossiê de Anomalia Prioritária',
        corpo:
`[ILLUSION DATABASE // FILE LOG v.2.4]

> FETCH FILE: IL-079
> STATUS: ATIVO · PRIORIDADE VERMELHA

RESUMO:
Anomalia de comportamento instável, com variação rápida de padrão.
Requer vigilância contínua pela R.E.C. e pela V.A.N.G.

NOTAS:
- Contenção considerada volátil.
- Qualquer mutação de padrão deve ser reportada ao V.I.S.
- Operadores não autorizados NÃO devem interagir diretamente.

END OF FILE.`
      },
      {
        codigo: 'IL-096',
        titulo: 'Registro de Reabilitação Controlada',
        corpo:
`[ILLUSION DATABASE // FILE LOG v.1.9]

> FETCH FILE: IL-096
> STATUS: MONITORADO

RESUMO:
Entidade anteriormente considerada incontrolável. Após longo protocolo de
reabilitação psicológica, encontra-se em regime de convivência supervisionada.

NOTAS:
- Interação humana permitida apenas com autorização NA-A+.
- Desencadeadores psicológicos ainda não totalmente mapeados.
- Qualquer reação fora do padrão deve acionar HALO imediatamente.

END OF FILE.`
      },
      {
        codigo: 'IL-173',
        titulo: 'Protocolo de Isolamento Total',
        corpo:
`[ILLUSION DATABASE // FILE LOG v.3.1]

> FETCH FILE: IL-173
> STATUS: ISOLAMENTO TOTAL

RESUMO:
Objeto mantido em confinamento rígido. Proibido toque físico,
aproximação não autorizada ou alteração estrutural na cela.

NOTAS:
- Entrada na ala requer dupla autenticação.
- Monitoramento visual redundante.
- Liberar acesso somente em caso de ordem direta do Conselho O5.

END OF FILE.`
      },
      {
        codigo: 'IL-071',
        titulo: 'Parasita com Hóspede.',
        corpo:
`[ILLUSION DATABASE // FILE LOG v.1.9]

> FETCH FILE: IL-071 “MURMÚRIO DE MÁRMORE”
> STATUS: ATIVA / ACOPLADA AO OPERADOR L-11.VIL (LI XIN)

RESUMO:
Entidade anímica de origem desconhecida, estruturada em mármore cinzento e
manifestando comportamento parasitário-simbiótico. Ativa somente após contato
visual prolongado, iniciando processo de fusão parcial com o hospedeiro.
Atualmente integrada ao sujeito Li Xin, influenciando capacidades físicas,
sensorialidade e estado psicológico.

NOTAS:
- A fusão altera densidade sanguínea, percepção temporal e reflexos motores.
- Entidade projeta “ecos de movimento”, ampliando visão e consciência espacial.
- Impactos corporais geram reverberação secundária (golpe ecoado).
- IL-Δ71 pode criar zona de silêncio absoluto (aprox. 30m).
- Fatores emocionais do hospedeiro definem qual forma se manifesta (sombria/luminosa).
- Exposição a reflexos ou superfícies espelhadas reduz mobilidade e percepção.
- Remoção voluntária é impossível; separação forçada implica risco extremo ao hospedeiro.

RISCO OPERACIONAL:
Classificada como ANOMALIA ATIVA DE RISCO MODERADO-HIGH durante simbiose.
Monitoramento constante é obrigatório. Episódios de alucinação sensorial e
disfunção cognitiva devem ser reportados a V.I.S./ARC imediatamente.

END OF FILE.`
      },
      {
        codigo: 'IL-404',
        titulo: 'Recurso Estratégico em Hibernação',
        corpo:
`[ILLUSION DATABASE // FILE LOG v.0.9]

> FETCH FILE: IL-404
> STATUS: HIBERNAÇÃO

RESUMO:
Ativo reservado para cenários de crise extrema. Detalhes completos
são liberados apenas para NA-E+.

NOTAS:
- Não utilizar sem aprovação documentada.
- Impacto potencial sobre múltiplas linhas operacionais.
- Conteúdo completo permanece cifrado em camadas profundas do ARC.

END OF FILE.`
      }
    ];

    const WEBHOOK_URL =
      "https://ptb.discord.com/api/webhooks/1445617873707077674/JmVCQK--8JP9hcUyYTNIs0mnW4_aNaHywD1AcwUSCqa-Gf6DfldM37NH_D7BlIjJHK2W";

    // --------- TERMINAL / TYPER ---------
    const termOutput = document.getElementById('terminal-output');
    const termForm = document.getElementById('terminal-form');
    const termInput = document.getElementById('terminal-input');

    const outputQueue = [];
    let isTyping = false;

    function appendRawLine(text, className = '') {
      const line = document.createElement('div');
      line.className = 'terminal-line ' + className;
      line.textContent = text;
      termOutput.appendChild(line);
      termOutput.scrollTop = termOutput.scrollHeight;
    }

    function enqueueOutput(text, className = 'term-system') {
      // suporta múltiplas linhas
      const lines = String(text).split('\n');
      lines.forEach((l) => {
        outputQueue.push({ text: l, className });
      });
      if (!isTyping) processQueue();
    }

    function processQueue() {
      if (!outputQueue.length) {
        isTyping = false;
        return;
      }
      isTyping = true;
      const { text, className } = outputQueue.shift();
      typeLine(text, className, processQueue);
    }

    function typeLine(text, className, done) {
      const line = document.createElement('div');
      line.className = 'terminal-line ' + className;
      termOutput.appendChild(line);

      let i = 0;
      const speed = 8; // ms por caractere (rápido, mas visível)

      function tick() {
        if (i < text.length) {
          line.textContent += text.charAt(i);
          i++;
          termOutput.scrollTop = termOutput.scrollHeight;
          setTimeout(tick, speed);
        } else {
          done && done();
        }
      }
      tick();
    }

    function clearTerminal() {
      termOutput.innerHTML = '';
    }

    function initTerminalSession() {
      clearTerminal();
      const header =
`[ILLUSION DATABASE // AGENT TERMINAL v.3.8]

> SESSION: ${currentUser.codename}
> ACCESS LEVEL: ${currentUser.access}
 
Olá, ${currentUser.codename}.
Digite 'help' para listar os comandos disponíveis.`;
      enqueueOutput(header, 'term-header');
    }

    // --------- BUSCAS ---------
    function searchAgents(query) {
      const q = query.toLowerCase();
      return AGENTS.filter(a =>
        a.nome.toLowerCase().includes(q) ||
        a.id.toLowerCase().includes(q) ||
        (a.divPrim && a.divPrim.toLowerCase().includes(q)) ||
        (a.divSec && a.divSec.toLowerCase().includes(q))
      );
    }

    function searchFiles(query) {
      const q = query.toLowerCase();
      return FILES.filter(f =>
        f.codigo.toLowerCase().includes(q) ||
        f.titulo.toLowerCase().includes(q)
      );
    }

    function formatAgent(agent) {
      const divSec = agent.divSec ? agent.divSec : '—';
      return (
`[ILLUSION DATABASE // AGENT PROFILE v.3.8]

> FETCH AGENT FILE: ${agent.id}
> STATUS: ACTIVE

DATA BLOCK A: IDENTIFICAÇÃO
• Nome: ${agent.nome}
• ID Interno: ${agent.id}
• Acesso: ${agent.acesso}
• Divisão Primária: ${agent.divPrim}
• Divisão Secundária: ${divSec}

DATA BLOCK B: DESCRIÇÃO
• Quirk Relacionada: ${agent.quirk}
• Descrição Física: ${agent.descFisica}
• Descrição: ${agent.descricao}

DATA BLOCK C: ANÁLISES
• Histórico de Missões: ${agent.historico}
• Anomalias associadas: ${agent.anomalias}
• Observações: ${agent.observacoes}

END OF FILE.`
      );
    }

    function formatHelp() {
      return (
`COMANDOS DISPONÍVEIS:

help
  • Exibe esta ajuda.

.agent <nome ou trecho>
  • Busca um agente e mostra o dossiê completo.

.list
  • Lista todos os agentes com divisão secundária (ou primária).

.arq
  • Lista todos os arquivos cadastrados.

.arq <nome ou trecho>
  • Busca um arquivo específico e exibe o conteúdo.

.report <texto>
  • Envia um relatório curto para o núcleo da Illusion (Discord webhook).

.ping
  • Verifica resposta do terminal.

.whoami
  • Mostra a sessão atual.

.clear
  • Limpa a tela do terminal.`
      );
    }

    // --------- HANDLE COMMANDS ---------
    termForm.addEventListener('submit', (event) => {
      event.preventDefault();
      const raw = termInput.value.trim();
      if (!raw) return;
      appendRawLine('> ' + raw, 'term-prompt-line');
      termInput.value = '';
      handleCommand(raw);
    });

    function handleCommand(raw) {
      const parts = raw.split(/\s+/);
      const cmd = (parts[0] || '').toLowerCase();
      const args = parts.slice(1);
      const rest = raw.slice(cmd.length).trim();

      switch (cmd) {
        case 'help':
          enqueueOutput(formatHelp(), 'term-system');
          break;

        case '.agent':
          if (!rest) {
            enqueueOutput('Uso: .agent <nome ou trecho>', 'term-error');
            return;
          }
          const agents = searchAgents(rest);
          if (agents.length === 0) {
            enqueueOutput('Nenhum agente encontrado para "' + rest + '".', 'term-error');
          } else if (agents.length === 1) {
            enqueueOutput(formatAgent(agents[0]), 'term-system');
          } else {
            const list =
              'Múltiplos agentes encontrados:\n' +
              agents.map(a => `• ${a.nome} — ${a.id}`).join('\n') +
              '\n\nRefine a busca: .agent <nome mais específico>';
            enqueueOutput(list, 'term-system');
          }
          break;

        case '.list':
          const list =
            'AGENTES REGISTRADOS:\n' +
            AGENTS.map(a => {
              const div = a.divSec || a.divPrim;
              return `• ${a.nome} — ${div}`;
            }).join('\n');
          enqueueOutput(list, 'term-system');
          break;

        case '.arq':
          if (!rest) {
            const filesList =
              'ARQUIVOS REGISTRADOS:\n' +
              FILES.map(f => `• ${f.codigo} — ${f.titulo}`).join('\n') +
              '\n\nUse: .arq <código ou trecho> para detalhar.';
            enqueueOutput(filesList, 'term-system');
          } else {
            const files = searchFiles(rest);
            if (files.length === 0) {
              enqueueOutput('Nenhum arquivo encontrado para "' + rest + '".', 'term-error');
            } else if (files.length === 1) {
              enqueueOutput(files[0].corpo, 'term-system');
            } else {
              const many =
                'Múltiplos arquivos encontrados:\n' +
                files.map(f => `• ${f.codigo} — ${f.titulo}`).join('\n') +
                '\n\nRefine a busca: .arq <código ou nome mais específico>';
              enqueueOutput(many, 'term-system');
            }
          }
          break;

        case '.ping':
          enqueueOutput('Terminal online // resposta nominal.', 'term-system');
          break;

        case '.whoami':
          if (!currentUser) {
            enqueueOutput('Nenhuma sessão ativa.', 'term-error');
          } else {
            enqueueOutput(
              `Sessão atual:\n• Usuário: ${currentUser.user}\n• Codinome: ${currentUser.codename}\n• Acesso: ${currentUser.access}`,
              'term-system'
            );
          }
          break;

        case '.clear':
          clearTerminal();
          break;

        case '.report':
          if (!rest) {
            enqueueOutput('Uso: .report <texto curto do relatório>', 'term-error');
            return;
          }
          sendReport(rest);
          break;

        default:
          enqueueOutput(`Comando não reconhecido: ${cmd}. Digite 'help' para ajuda.`, 'term-error');
          break;
      }
    }

    async function sendReport(text) {
      if (!currentUser) {
        enqueueOutput('Sem sessão autenticada. Não é possível enviar relatório.', 'term-error');
        return;
      }

      const timestamp = new Date().toLocaleString('pt-BR');
      const content =
`ILLUSION // REPORT VIA TERMINAL

Operador: ${currentUser.codename} (${currentUser.user})
Acesso: ${currentUser.access}
Timestamp: ${timestamp}

Conteúdo:
${text}

Canal monitorado por V.I.S. / R.E.C.`;

      try {
        const resp = await fetch(WEBHOOK_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ content })
        });

        if (!resp.ok) throw new Error("HTTP " + resp.status);
        enqueueOutput('Relatório encapsulado e encaminhado ao núcleo da Illusion.', 'term-system');
      } catch (err) {
        console.error(err);
        enqueueOutput('Falha ao transmitir relatório. Verifique o canal externo.', 'term-error');
      }
    }
  </script>
</body>
</html>
